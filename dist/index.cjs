"use strict";var E=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var l=(r,t)=>{for(var n in t)E(r,n,{get:t[n],enumerable:!0})},f=(r,t,n,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of u(t))!p.call(r,i)&&i!==n&&E(r,i,{get:()=>t[i],enumerable:!(e=a(t,i))||e.enumerable});return r};var m=r=>f(E({},"__esModule",{value:!0}),r);var c={};l(c,{Emitter:()=>v,EmitterDedupe:()=>d});module.exports=m(c);var d={ADD:"add",UPDATE:"update",IGNORE:"ignore",THROW:"throw"},v=class{constructor(t={}){this.dedupe=t.dedupe||d.ADD,this.getId=t.getId||(()=>Symbol()),this._events=new Map}_getListeners(t){let n=this._events.get(t);if(n){let e=n.m;if(e.size)return n.l=n.l||[...e.values()]}return null}on(t,n,e){let i=this._events,s=i.get(t);s||(s={m:new Map,l:null},i.set(t,s));let o=s.m;if(e=e===void 0?this.getId(n):e,o.has(e))switch(this.dedupe){case d.THROW:throw new Error("Eventti: duplicate listener id!");case d.IGNORE:return e;case d.UPDATE:{s.l=null;break}default:o.delete(e),s.l=null}return o.set(e,n),s.l?.push(n),e}once(t,n,e){let i=!1;return e=e===void 0?this.getId(n):e,this.on(t,(...s)=>{i||(i=!0,this.off(t,e),n(...s))},e)}off(t,n){if(t===void 0){this._events.clear();return}if(n===void 0){this._events.delete(t);return}let e=this._events.get(t);e&&e.m.delete(n)&&(e.l=null,e.m.size||this._events.delete(t))}emit(t,...n){let e=this._getListeners(t);if(e){let i=e.length,s=0;if(n.length)for(;s<i;s++)e[s](...n);else for(;s<i;s++)e[s]()}}listenerCount(t){if(t===void 0){let n=0;return this._events.forEach(e=>{n+=e.m.size}),n}return this._events.get(t)?.m.size||0}};0&&(module.exports={Emitter,EmitterDedupe});
