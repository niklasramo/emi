!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).Emi={})}(this,function(e){"use strict";function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,i){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,i){if(e){if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,i):void 0}}(e))||i&&e&&"number"==typeof e.length){n&&(e=n);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e,t){var i=e.get(t);return i||(i=new s,e.set(t,i)),i}var s=/*#__PURE__*/function(){function e(){this.idMap=void 0,this.fnMap=void 0,this.onceList=void 0,this.emitList=void 0,this.idMap=new Map,this.fnMap=new Map,this.onceList=new Set,this.emitList=null}var t=e.prototype;return t.addListener=function(e,t){var i,n=this.fnMap.get(e);n||(n=new Set,this.fnMap.set(e,n));var s=Symbol();return n.add(s),this.idMap.set(s,e),t&&this.onceList.add(s),null==(i=this.emitList)||i.push(e),s},t.deleteListener=function(e){if(this.idMap.has(e)){var t=this.idMap.get(e),i=this.fnMap.get(t);this.onceList.delete(e),this.idMap.delete(e),i.delete(e),i.size||this.fnMap.delete(t),this.emitList=null}},t.deleteListeners=function(e){var t=this.fnMap.get(e);if(t){for(var n,s=i(t);!(n=s()).done;){var r=n.value;this.onceList.delete(r),this.idMap.delete(r)}this.fnMap.delete(e),this.emitList=null}},e}(),r=/*#__PURE__*/function(){function e(){this._events=void 0,this._events=new Map}var t=e.prototype;return t.on=function(e,t){return n(this._events,e).addListener(t)},t.once=function(e,t){return n(this._events,e).addListener(t,!0)},t.off=function(e,t){if(void 0!==e)if(void 0!==t){var i=this._events.get(e);i&&("function"==typeof t?i.deleteListeners(t):i.deleteListener(t),i.idMap.size||this._events.delete(e))}else this._events.delete(e);else this._events.clear()},t.emit=function(e){var t=this._events.get(e);if(t){var n=t.idMap,s=t.onceList;if(!n.size){var r=t.emitList||[].concat(n.values());if(s.size)if(s.size===n.size)this._events.delete(e);else for(var o,a=i(s);!(o=a()).done;){var l=o.value;t.deleteListener(l)}else t.emitList=r;for(var f=0,d=r.length;f<d;f++)r[f].apply(r,[].slice.call(arguments,1))}}},e}();function o(e,t){var i=e.get(t);return i||(i={listeners:new Set,onceListeners:new Set,emitList:null},e.set(t,i)),i}var a=/*#__PURE__*/function(){function e(){this._events=void 0,this._events=new Map}var t=e.prototype;return t.on=function(e,t){var i=o(this._events,e),n=i.listeners,s=i.emitList;return n.has(t)||(n.add(t),null==s||s.push(t)),t},t.once=function(e,t){var i=o(this._events,e),n=i.listeners,s=i.onceListeners,r=i.emitList;return n.has(t)||(n.add(t),s.add(t),null==r||r.push(t)),t},t.off=function(e,t){if(void 0!==e)if(void 0!==t){var i=this._events.get(e);i&&(i.listeners.delete(t),i.onceListeners.delete(t),i.emitList=null,i.listeners.size||this._events.delete(e))}else this._events.delete(e);else this._events.clear()},t.emit=function(e,t){var n=this._events.get(e);if(n){var s=n.listeners,r=n.onceListeners;if(s.size){var o=n.emitList||[].concat(s);if(r.size)if(r.size===s.size)this._events.delete(e);else{for(var a,l=i(r);!(a=l()).done;)s.delete(a.value);r.clear(),n.emitList=null}else n.emitList=o;for(var f=0,d=o.length;f<d;f++)o[f](t)}}},e}();e.Emitter=r,e.UniqueEmitter=a});
//# sourceMappingURL=emi.umd.js.map
