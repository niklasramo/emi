"use strict";var eventti=(()=>{var o=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var c=Object.prototype.hasOwnProperty;var l=(s,e)=>{for(var t in e)o(s,t,{get:e[t],enumerable:!0})},m=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of p(e))!c.call(s,i)&&i!==t&&o(s,i,{get:()=>e[i],enumerable:!(n=u(e,i))||n.enumerable});return s};var f=s=>m(o({},"__esModule",{value:!0}),s);var h={};l(h,{Emitter:()=>E,EmitterDedupeMode:()=>d});var d={ADD:"add",UPDATE:"update",IGNORE:"ignore",THROW:"throw"},a=class{constructor(){this.idMap=new Map,this.emitList=null}add(e,t,n){if(this.idMap.has(t))switch(n){case d.THROW:throw new Error("Eventti: duplicate listener id!");case d.IGNORE:return t;case d.UPDATE:{this.emitList=null;break}default:this.del(t)}return this.idMap.set(t,e),this.emitList?.push(e),t}del(e){this.idMap.delete(e)&&(this.emitList=null)}},E=class{constructor(e={}){let{dedupeMode:t=d.ADD,createId:n=()=>Symbol()}=e;this.dedupeMode=t,this.createId=n,this._events=new Map}_getListeners(e){let t=this._events.get(e);if(t){let{idMap:n}=t;if(n.size)return t.emitList=t.emitList||[...n.values()]}return null}on(e,t,n){let{_events:i}=this,r=i.get(e);return r||(r=new a,i.set(e,r)),r.add(t,n===void 0?this.createId(t):n,this.dedupeMode)}once(e,t,n){let i=n===void 0?this.createId(t):n,r=!1;return this.on(e,(...v)=>{r||(r=!0,this.off(e,i),t(...v))},i)}off(e,t){if(e===void 0){this._events.clear();return}if(t===void 0){this._events.delete(e);return}let n=this._events.get(e);n&&(n.del(t),n.idMap.size||this._events.delete(e))}emit(e,...t){let n=this._getListeners(e);if(!n)return;let i=0,r=n.length;for(;i<r;i++)n[i](...t)}listenerCount(e){if(e===void 0){let t=0;return this._events.forEach((n,i)=>{t+=this.listenerCount(i)}),t}return this._events.get(e)?.idMap.size||0}};return f(h);})();
